<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>chan in,out;//Infrared sensors
chan cardOK;
chan cardNOK;
chan cardIn;//Card inserted
chan porteO;
chan infra1;//The user wants to leave through gate 1. Stands before infrared 1.

const int GETOUT = 5;//After inserting card.
const int TIMEOUT_CLEAR = 10;//Leave the sas if no card inserted.
int inSas = 0;

bool gate1opened = true;
int gateConf = 1;//Binary: g2g1 =&gt; 01 = gate 2 closed &amp;&amp; gate 1 open, 00 both closed, 10 = gate 2 open &amp;&amp; gate 1 closed.
</declaration><template><name x="5" y="5">User</name><declaration>clock x,y;</declaration><location id="id0" x="-160" y="-288"><label kind="invariant" x="-170" y="-273">x&lt;=TIMEOUT_CLEAR</label></location><location id="id1" x="-272" y="-448"><name x="-328" y="-488">EJECT_USER</name></location><location id="id2" x="200" y="176"><name x="216" y="168">SAS_Opened</name><label kind="invariant" x="216" y="192">y&lt;=GETOUT</label></location><location id="id3" x="432" y="-256"><name x="464" y="-272">CARD_INSERTED</name></location><location id="id4" x="-120" y="-48" color="#00ff00"><name x="-144" y="-16">After_SAS</name></location><location id="id5" x="72" y="-320"><name x="80" y="-352">In_SAS</name><label kind="invariant" x="72" y="-304">x&lt;=TIMEOUT_CLEAR</label></location><location id="id6" x="-368" y="-208"><name x="-464" y="-240">Before_SAS</name></location><init ref="id6"/><transition action=""><source ref="id0"/><target ref="id1"/><label kind="guard" x="-200" y="-368">x==TIMEOUT_CLEAR</label><nail x="-200" y="-376"/></transition><transition controllable="false" action=""><source ref="id0"/><target ref="id6"/><label kind="guard" x="-324" y="-278">gateConf==1</label><label kind="synchronisation" x="-324" y="-263">out!</label></transition><transition controllable="false" action=""><source ref="id5"/><target ref="id0"/><label kind="synchronisation" x="-104" y="-319">infra1!</label></transition><transition controllable="false" action=""><source ref="id5"/><target ref="id2"/><label kind="guard" x="128" y="-136">gateConf == 2</label><nail x="168" y="-56"/></transition><transition action=""><source ref="id3"/><target ref="id5"/><label kind="synchronisation" x="256" y="-424">cardNOK?</label><nail x="416" y="-408"/><nail x="184" y="-408"/></transition><transition controllable="false" action=""><source ref="id2"/><target ref="id5"/><label kind="comments">The user simply decide not to go out.
He can reinsert his card or leave by the first door.</label><nail x="48" y="-200"/></transition><transition action=""><source ref="id1"/><target ref="id6"/><label kind="synchronisation" x="-336" y="-360">out!</label></transition><transition action=""><source ref="id2"/><target ref="id1"/><label kind="guard" x="80" y="184">y==GETOUT</label><nail x="72" y="176"/><nail x="-504" y="-80"/><nail x="-488" y="-320"/></transition><transition action=""><source ref="id3"/><target ref="id2"/><label kind="synchronisation" x="320" y="-48">cardOK?</label><label kind="assignment" x="328" y="-32">y=0</label></transition><transition controllable="false" action=""><source ref="id2"/><target ref="id4"/><label kind="synchronisation" x="24" y="32">out!</label><label kind="comments">The user leaves the sas.</label></transition><transition controllable="false" action=""><source ref="id5"/><target ref="id3"/><label kind="synchronisation" x="288" y="-280">cardIn!</label><nail x="168" y="-248"/></transition><transition action=""><source ref="id5"/><target ref="id1"/><label kind="guard" x="-104" y="-440">x==TIMEOUT_CLEAR</label><nail x="-80" y="-416"/></transition><transition controllable="false" action=""><source ref="id4"/><target ref="id6"/></transition><transition controllable="false" action=""><source ref="id6"/><target ref="id5"/><label kind="guard" x="-184" y="-224">gateConf == 1</label><label kind="synchronisation" x="-112" y="-192">in!</label><label kind="assignment" x="-56" y="-192">x=0</label><nail x="-56" y="-192"/></transition></template><template><name>SAS</name><declaration>clock x,y;</declaration><location id="id7" x="-1400" y="-432"></location><location id="id8" x="-816" y="-256"><name x="-864" y="-240">Process_Card</name></location><location id="id9" x="-1104" y="-328"><name x="-1136" y="-368">USER_IN</name></location><location id="id10" x="-1552" y="-240"><name x="-1592" y="-272">Init</name></location><init ref="id10"/><transition action=""><source ref="id8"/><target ref="id9"/><label kind="synchronisation" x="-816" y="-480">cardOK!</label><label kind="assignment" x="-744" y="-400">gateConf=2</label><nail x="-744" y="-352"/><nail x="-888" y="-432"/></transition><transition controllable="false" action=""><source ref="id7"/><target ref="id10"/><label kind="synchronisation" x="-1512" y="-384">out?</label><nail x="-1488" y="-336"/></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id7"/><label kind="synchronisation" x="-1336" y="-440">infra1?</label><label kind="assignment" x="-1256" y="-424">gateConf=1</label><nail x="-1208" y="-392"/></transition><transition action=""><source ref="id8"/><target ref="id9"/><label kind="synchronisation" x="-1008" y="-240">cardNOK!</label><nail x="-984" y="-248"/></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id10"/><label kind="synchronisation" x="-1232" y="-352">out?</label><label kind="assignment" x="-1256" y="-328">gateConf = 1</label><nail x="-1224" y="-336"/></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id8"/><label kind="synchronisation" x="-936" y="-360">cardIn?</label><nail x="-912" y="-336"/></transition><transition controllable="false" action=""><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-1224" y="-304">in?</label><label kind="assignment" x="-1224" y="-272">gateConf = 0</label><nail x="-1216" y="-280"/><nail x="-1144" y="-288"/></transition></template><system>system User, SAS;</system></nta>