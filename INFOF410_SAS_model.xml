<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>chan in,out;//Infrared sensors
chan cardOK;
chan cardNOK;
chan cardIn;//Card inserted

const int GETOUT = 5;//After inserting card.
const int TIMEOUT_CLEAR = 10;//Leave the sas if no card inserted.
int inSas = 0;</declaration><template><name x="5" y="5">User</name><declaration>clock x,y;</declaration><location id="id0" x="-272" y="-448"><name x="-328" y="-488">EJECT_USER</name></location><location id="id1" x="200" y="176"><name x="216" y="168">SAS_Opened</name><label kind="invariant" x="216" y="192">y&lt;GETOUT</label></location><location id="id2" x="360" y="-248"><name x="392" y="-264">CARD_INSERTED</name></location><location id="id3" x="-120" y="-48" color="#00ff00"><name x="-144" y="-16">After_SAS</name></location><location id="id4" x="16" y="-256"><name x="24" y="-288">In_SAS</name><label kind="invariant" x="16" y="-240">x&lt;TIMEOUT_CLEAR</label></location><location id="id5" x="-320" y="-248"><name x="-416" y="-280">Before_SAS</name></location><init ref="id5"/><transition controllable="false" action=""><source ref="id1"/><target ref="id4"/><label kind="comments">The user simply decide not to go out.
He can reinsert his card or leave by the first door.</label><nail x="-16" y="-200"/></transition><transition action=""><source ref="id0"/><target ref="id5"/><label kind="synchronisation" x="-288" y="-352">out!</label></transition><transition action=""><source ref="id1"/><target ref="id0"/><label kind="guard" x="80" y="184">y==GETOUT</label><nail x="72" y="176"/><nail x="-504" y="-80"/><nail x="-488" y="-320"/></transition><transition action=""><source ref="id2"/><target ref="id0"/><label kind="synchronisation" x="8" y="-504">cardNOK?</label><label kind="comments">If the card is not accepted, get the hell out of the sas.</label><nail x="320" y="-504"/><nail x="-200" y="-504"/></transition><transition action=""><source ref="id2"/><target ref="id1"/><label kind="synchronisation" x="220" y="-51">cardOK?</label><label kind="assignment" x="232" y="-32">y=0</label></transition><transition controllable="false" action=""><source ref="id1"/><target ref="id3"/><label kind="synchronisation" x="24" y="32">out!</label><label kind="comments">The user leaves the sas.</label></transition><transition controllable="false" action=""><source ref="id4"/><target ref="id2"/><label kind="synchronisation" x="136" y="-272">cardIn!</label></transition><transition action=""><source ref="id4"/><target ref="id0"/><label kind="guard" x="-104" y="-440">x==TIMEOUT_CLEAR</label><nail x="-80" y="-416"/></transition><transition controllable="false" action=""><source ref="id4"/><target ref="id5"/><label kind="synchronisation" x="-136" y="-200">out!</label><label kind="comments">The user can get out at any time he wants.</label><nail x="-120" y="-208"/></transition><transition controllable="false" action=""><source ref="id3"/><target ref="id5"/></transition><transition controllable="false" action=""><source ref="id5"/><target ref="id4"/><label kind="synchronisation" x="-160" y="-296">in!</label><label kind="assignment" x="-168" y="-264">x=0</label><nail x="-152" y="-272"/></transition></template><template><name>SAS</name><declaration>clock x,y;</declaration><location id="id6" x="-656" y="-280"></location><location id="id7" x="-720" y="-488"></location><location id="id8" x="-888" y="-328"><name x="-936" y="-312">Process_Card</name></location><location id="id9" x="-1104" y="-328"><name x="-1176" y="-352">USER_IN</name></location><location id="id10" x="-1328" y="-280"><name x="-1368" y="-312">Init</name></location><init ref="id10"/><transition controllable="false" action=""><source ref="id7"/><target ref="id9"/></transition><transition action=""><source ref="id6"/><target ref="id10"/><label kind="synchronisation" x="-1176" y="-152">out?</label><nail x="-1168" y="-160"/></transition><transition action=""><source ref="id7"/><target ref="id10"/><label kind="synchronisation" x="-1184" y="-480">out?</label><nail x="-1184" y="-456"/></transition><transition action=""><source ref="id8"/><target ref="id6"/><label kind="synchronisation" x="-808" y="-296">cardNOK!</label></transition><transition action=""><source ref="id8"/><target ref="id7"/><label kind="synchronisation" x="-808" y="-408">cardOK!</label></transition><transition controllable="false" action=""><source ref="id9"/><target ref="id8"/><label kind="synchronisation" x="-1024" y="-352">cardIn?</label></transition><transition controllable="false" action=""><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-1224" y="-304">in?</label><nail x="-1216" y="-280"/></transition></template><system>system User, SAS;</system></nta>